import{H}from"./hammer-BRjDnnGP.js";import{m as L,e as O,j as A,b as v,d as D,o as g,c as y,a,t as x,u as h,F as N,r as C,h as G,n as U,f as P,_ as V,p as W}from"./index-Crvd5xHI.js";const S=20,B=3,M=150;var l=(s=>(s.UP="up",s.DOWN="down",s.LEFT="left",s.RIGHT="right",s))(l||{});const j={up:"down",down:"up",left:"right",right:"left"};function K(){const s=v([]),f=v({x:0,y:0}),i=v(l.RIGHT),c=v(l.RIGHT),o=v(!1),d=v(!1),p=v(0),w=v(0);let n=null;const $=A(()=>d.value?"æ¸¸æˆç»“æŸ":o.value?"æ¸¸æˆä¸­...":"æŒ‰æ–¹å‘é”®å¼€å§‹");function m(){let e,t;do e={x:Math.floor(Math.random()*S),y:Math.floor(Math.random()*S)},t=!s.value.some(F=>F.x===e.x&&F.y===e.y);while(!t);f.value=e}function k(){s.value=[];for(let e=0;e<B;e++)s.value.push({x:B-1-e,y:Math.floor(S/2)})}function r(){i.value=c.value;const t={...s.value[0]};switch(i.value){case l.UP:t.y-=1;break;case l.DOWN:t.y+=1;break;case l.LEFT:t.x-=1;break;case l.RIGHT:t.x+=1;break}if(T(t)){E();return}s.value.unshift(t),t.x===f.value.x&&t.y===f.value.y?(p.value+=10,m()):s.value.pop()}function T(e){return e.x<0||e.x>=S||e.y<0||e.y>=S?!0:s.value.some(t=>t.x===e.x&&t.y===e.y)}function I(){o.value&&!d.value&&r()}function b(){o.value=!0,d.value=!1,p.value=0,i.value=l.RIGHT,c.value=l.RIGHT,k(),m(),n&&clearInterval(n),n=window.setInterval(I,M)}function R(){o.value=!1,n&&(clearInterval(n),n=null)}function z(){d.value||(o.value=!0,n&&clearInterval(n),n=window.setInterval(I,M))}function E(){o.value=!1,d.value=!0,n&&(clearInterval(n),n=null),p.value>w.value&&(w.value=p.value)}function _(){b()}function u(e){j[e]!==i.value&&(c.value=e)}return L(()=>{k(),m()}),O(()=>{n&&clearInterval(n)}),{snake:s,food:f,isPlaying:o,isGameOver:d,score:p,bestScore:w,statusText:$,startGame:b,pauseGame:R,continueGame:z,restartGame:_,changeDirection:u}}const Z={class:"snake-game"},q={class:"game-header"},J={class:"score-info"},Q={class:"score-item"},X={class:"score-value"},Y={class:"score-item"},ee={class:"score-value"},ae={class:"status-text"},te={class:"game-board"},se={class:"board"},ne={class:"grid-lines"},oe={key:0,class:"start-overlay"},le={key:0,class:"game-over-overlay"},ie={class:"game-over-content"},ce={class:"game-over-score"},re=D({__name:"SnakeBoard",setup(s){const{snake:f,food:i,isPlaying:c,isGameOver:o,score:d,bestScore:p,statusText:w,startGame:n,restartGame:$,changeDirection:m}=K(),k=v(null);let r=null;function T(_){return{left:`${_.x*5}%`,top:`${_.y*5}%`,width:"5%",height:"5%"}}function I(){return{left:`${i.value.x*5}%`,top:`${i.value.y*5}%`,width:"5%",height:"5%"}}function b(){n()}function R(){$()}function z(){if(!k.value)return;r=new H.Manager(k.value);const _=new H.Swipe({direction:H.DIRECTION_ALL,threshold:30});r.add(_),r.on("swipeup",()=>{c.value&&m(l.UP)}),r.on("swipedown",()=>{c.value&&m(l.DOWN)}),r.on("swipeleft",()=>{c.value&&m(l.LEFT)}),r.on("swiperight",()=>{c.value&&m(l.RIGHT)})}function E(){r&&(r.destroy(),r=null)}return L(()=>{z()}),O(()=>{E()}),(_,u)=>(g(),y("div",Z,[a("div",q,[a("div",J,[a("div",Q,[u[0]||(u[0]=a("span",{class:"score-label"},"åˆ†æ•°",-1)),a("span",X,x(h(d)),1)]),a("div",Y,[u[1]||(u[1]=a("span",{class:"score-label"},"æœ€é«˜åˆ†",-1)),a("span",ee,x(h(p)),1)])]),a("div",ae,x(h(w)),1)]),a("div",te,[a("div",{class:"board-container",ref_key:"boardRef",ref:k},[a("div",se,[a("div",ne,[(g(),y(N,null,C(20,e=>a("div",{key:`h-${e}`,class:"grid-line grid-line-horizontal",style:G({top:`${(e-1)*5}%`})},null,4)),64)),(g(),y(N,null,C(20,e=>a("div",{key:`v-${e}`,class:"grid-line grid-line-vertical",style:G({left:`${(e-1)*5}%`})},null,4)),64))]),(g(!0),y(N,null,C(h(f),(e,t)=>(g(),y("div",{key:`snake-${t}`,class:U(["snake-segment",{"snake-head":t===0}]),style:G(T(e))},null,6))),128)),a("div",{class:"food",style:G(I())},null,4),!h(c)&&!h(o)?(g(),y("div",oe,[a("button",{class:"start-button",onClick:b}," å¼€å§‹æ¸¸æˆ ")])):P("",!0)])],512)]),h(o)?(g(),y("div",le,[a("div",ie,[u[2]||(u[2]=a("div",{class:"game-over-icon"},"ğŸ’€",-1)),u[3]||(u[3]=a("div",{class:"game-over-title"},"æ¸¸æˆç»“æŸ",-1)),a("div",ce,"å¾—åˆ†ï¼š"+x(h(d)),1),a("button",{class:"restart-button",onClick:R}," é‡æ–°å¼€å§‹ ")])])):P("",!0)]))}}),ue=V(re,[["__scopeId","data-v-a7c65fbe"]]),de={class:"snake-view"},ve={class:"container"},fe={class:"game-layout"},me={class:"game-main"},_e=D({__name:"SnakeView",setup(s){function f(){window.close()}return L(()=>{const i=new BroadcastChannel("woodcat-games");i.onmessage=c=>{const o=c.data;o.type==="close-game"&&o.gameRoute!=="/game/snake"&&(i.close(),window.close())},O(()=>{i.close()})}),(i,c)=>(g(),y("div",de,[a("div",ve,[a("div",{class:"game-header"},[a("button",{onClick:f,class:"back-button"},"â† è¿”å›é¦–é¡µ")]),a("div",fe,[a("div",me,[W(ue)])])])]))}}),ye=V(_e,[["__scopeId","data-v-fced690f"]]);export{ye as default};
