import{k as M,b as m,w as ae,d as U,o as h,c as y,F as L,a as s,t as _,u as o,r as oe,n as B,g as R,_ as Z,e as ne,f as le,p as z,s as ie,v as ce,q as re}from"./index-CWkIdGNN.js";import{p as W}from"./persistenceService-D2TLTx3Y.js";import{a as k,S as V,v as C,V as O}from"./vibrationService-DXRESRMj.js";var t=(e=>(e.EMPTY="",e.X="X",e.O="O",e))(t||{}),d=(e=>(e.PLAYING="playing",e.X_WINS="x_wins",e.O_WINS="o_wins",e.DRAW="draw",e))(d||{});const H=3,ue=[[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]];var v=(e=>(e.PVP="pvp",e.PVE="pve",e))(v||{});const T=m([]),f=m(t.X),P=m(d.PLAYING),x=m(v.PVP),p=m(null),N=m(0),b=m(0),A=m(0),E=m(!1);function j(){const e=W.loadTicTacToeGame();N.value=e.stats.xWins,b.value=e.stats.oWins,A.value=e.stats.draws,J()}function ve(){const e=W.loadTicTacToeGame();W.saveTicTacToeGame({stats:e.stats,gameState:null})}ae([N,b,A],()=>{const e=W.loadTicTacToeGame();W.saveTicTacToeGame({stats:{xWins:N.value,oWins:b.value,draws:A.value},gameState:e.gameState})});j();const de=M(()=>P.value===d.X_WINS?"X èŽ·èƒœï¼":P.value===d.O_WINS?"O èŽ·èƒœï¼":P.value===d.DRAW?"å¹³å±€ï¼":`å½“å‰å›žåˆï¼š${f.value}`);function J(){T.value=Array(H*H).fill(t.EMPTY)}function D(e,c){return ue.some(n=>n.every(l=>e[l]===c))}function K(e){return e.every(c=>c!==t.EMPTY)}function F(e,c,n,l,r){if(D(e,l))return 10-c;if(D(e,r))return c-10;if(K(e))return 0;if(n){let u=-1/0;for(let i=0;i<9;i++)if(e[i]===t.EMPTY){e[i]=l;const X=F(e,c+1,!1,l,r);e[i]=t.EMPTY,u=Math.max(X,u)}return u}else{let u=1/0;for(let i=0;i<9;i++)if(e[i]===t.EMPTY){e[i]=r;const X=F(e,c+1,!0,l,r);e[i]=t.EMPTY,u=Math.min(X,u)}return u}}function fe(){if(!p.value)return null;const e=p.value,c=p.value===t.X?t.O:t.X;let n=-1/0,l=null;for(let r=0;r<9;r++)if(T.value[r]===t.EMPTY){T.value[r]=e;const u=F(T.value,0,!1,e,c);T.value[r]=t.EMPTY,u>n&&(n=u,l=r)}return l}function Q(){P.value!==d.PLAYING||f.value!==p.value||(E.value=!0,setTimeout(()=>{const e=fe();e!==null?(E.value=!1,ee(e,!0)):E.value=!1},500))}function ee(e,c=!1){return P.value!==d.PLAYING||T.value[e]!==t.EMPTY||E.value&&!c||x.value===v.PVE&&f.value===p.value&&!c?!1:(T.value[e]=f.value,f.value===t.X?(k.play(V.PLACE_X),C.vibrate(O.PLACE_X)):(k.play(V.PLACE_O),C.vibrate(O.PLACE_O)),D(T.value,f.value)?(P.value=f.value===t.X?d.X_WINS:d.O_WINS,P.value===d.X_WINS?N.value++:b.value++,k.play(V.WIN),C.vibrate(O.WIN),!0):K(T.value)?(P.value=d.DRAW,A.value++,k.play(V.DRAW),C.vibrate(O.DRAW),!0):(f.value=f.value===t.X?t.O:t.X,x.value===v.PVE&&f.value===p.value&&Q(),!0))}function se(){J(),P.value=d.PLAYING,E.value=!1,f.value=t.X,x.value===v.PVE?Math.random()<.5?(p.value=t.X,setTimeout(()=>{Q()},300)):p.value=t.O:p.value=null}function me(){N.value=0,b.value=0,A.value=0,se()}function te(){return{board:T,currentPlayer:f,gameState:P,gameMode:x,aiPlayer:p,xWins:N,oWins:b,draws:A,isAIThinking:E,statusText:de,placePiece:ee,startNewGame:se,resetAllStats:me,loadGameState:j,clearGameState:ve}}const _e={class:"tictactoe-game"},Te={class:"game-header"},Pe={class:"score-info"},pe={class:"score-item"},ge={class:"score-value"},he={class:"score-item"},ye={class:"score-value"},Ie={class:"score-item"},Xe={class:"score-value"},Ee={class:"status-text"},Ne={class:"game-board"},be={class:"board-container"},Ae={class:"board"},We=["onClick"],we={key:0,class:"game-over-overlay"},ke={class:"game-over-content"},Ve={class:"game-over-icon"},Ce={class:"game-over-title"},Oe=U({__name:"TicTacToeBoard",setup(e){const{board:c,gameState:n,xWins:l,oWins:r,draws:u,statusText:i,placePiece:X,startNewGame:$,resetAllStats:S}=te();function w(g){X(g)}function G(){$()}function Y(){S()}return(g,a)=>(h(),y(L,null,[s("div",_e,[s("div",Te,[s("div",Pe,[s("div",pe,[a[0]||(a[0]=s("span",{class:"score-label"},"X",-1)),s("span",ge,_(o(l)),1)]),s("div",he,[a[1]||(a[1]=s("span",{class:"score-label"},"å¹³å±€",-1)),s("span",ye,_(o(u)),1)]),s("div",Ie,[a[2]||(a[2]=s("span",{class:"score-label"},"O",-1)),s("span",Xe,_(o(r)),1)])]),s("div",Ee,_(o(i)),1)]),s("div",Ne,[s("div",be,[s("div",Ae,[(h(!0),y(L,null,oe(o(c),(I,q)=>(h(),y("div",{key:q,class:B(["cell",{"cell-x":I===o(t).X,"cell-o":I===o(t).O}]),onClick:Ze=>w(q)},_(I),11,We))),128))])])])]),o(n)!==o(d).PLAYING?(h(),y("div",we,[s("div",ke,[s("div",Ve,_(o(n)===o(d).DRAW?"ðŸ¤":"ðŸŽ‰"),1),s("div",Ce,_(o(i)),1),s("div",{class:"game-over-buttons"},[s("button",{class:"new-game-button",onClick:G}," æ–°æ¸¸æˆ "),s("button",{class:"reset-all-button",onClick:Y}," é‡ç½®ç»Ÿè®¡ ")])])])):R("",!0)],64))}}),Me=Z(Oe,[["__scopeId","data-v-1af3e64c"]]),xe={class:"tictactoe-view"},$e={class:"container"},Se={key:0,class:"mode-selector"},Ge={class:"mode-selector-content"},Ye={class:"mode-buttons"},Le={key:0,class:"first-player-info"},Be={class:"first-player-text"},Re={key:1,class:"game-layout"},De={class:"game-main"},Fe={key:0,class:"color-hint-overlay"},qe={class:"color-hint-content"},ze={class:"color-hint-icon"},He={class:"color-hint-text"},Ue=U({__name:"TicTacToeView",setup(e){const c=re(),{gameMode:n,aiPlayer:l,startNewGame:r}=te(),u=m(!1),i=m(!1),X=M(()=>n.value!==v.PVE||!l.value?"Xå…ˆæ‰‹":l.value===t.X?"AIå…ˆæ‰‹ï¼ˆXï¼‰":"ä½ å…ˆæ‰‹ï¼ˆXï¼‰"),$=M(()=>n.value!==v.PVE||!l.value||l.value===t.O?"X":"O"),S=M(()=>n.value!==v.PVE||!l.value?"åŒäººå¯¹æˆ˜æ¨¡å¼":l.value===t.O?"ä½ æ‰§Xï¼ˆå…ˆæ‰‹ï¼‰":"ä½ æ‰§Oï¼ˆåŽæ‰‹ï¼‰");function w(g){n.value=g}function G(){u.value=!0,r(),n.value===v.PVE&&(i.value=!0,setTimeout(()=>{i.value=!1},3e3))}function Y(){c.push("/")}return ne(()=>{const g=new BroadcastChannel("woodcat-games");g.onmessage=a=>{const I=a.data;I.type==="close-game"&&I.gameRoute!=="/game/tictactoe"&&(g.close(),window.close())},le(()=>{g.close()})}),(g,a)=>(h(),y(L,null,[s("div",xe,[s("div",$e,[s("div",{class:"game-header"},[s("button",{onClick:Y,class:"back-button"},"â† è¿”å›žé¦–é¡µ")]),u.value?(h(),y("div",Re,[s("div",De,[z(Me)])])):(h(),y("div",Se,[s("div",Ge,[a[5]||(a[5]=s("div",{class:"mode-selector-title"},"é€‰æ‹©æ¸¸æˆæ¨¡å¼",-1)),s("div",Ye,[s("button",{class:B(["mode-button",{"mode-button--active":o(n)===o(v).PVP}]),onClick:a[0]||(a[0]=I=>w(o(v).PVP))},[...a[2]||(a[2]=[s("div",{class:"mode-icon"},"ðŸ‘¥",-1),s("div",{class:"mode-name"},"åŒäººå¯¹æˆ˜",-1),s("div",{class:"mode-desc"},"ä¸¤ä¸ªçŽ©å®¶è½®æµä¸‹æ£‹",-1)])],2),s("button",{class:B(["mode-button",{"mode-button--active":o(n)===o(v).PVE}]),onClick:a[1]||(a[1]=I=>w(o(v).PVE))},[...a[3]||(a[3]=[s("div",{class:"mode-icon"},"ðŸ¤–",-1),s("div",{class:"mode-name"},"äººæœºå¯¹æˆ˜",-1),s("div",{class:"mode-desc"},"ä¸ŽAIå¯¹æˆ˜ï¼ŒæŒ‘æˆ˜æ™ºèƒ½AI",-1)])],2)]),o(n)===o(v).PVE?(h(),y("div",Le,[a[4]||(a[4]=s("div",{class:"first-player-icon"},"ðŸŽ²",-1)),s("div",Be,_(X.value),1)])):R("",!0),s("button",{class:"start-game-button",onClick:G}," å¼€å§‹æ¸¸æˆ ")])]))])]),z(ce,{name:"fade"},{default:ie(()=>[i.value?(h(),y("div",Fe,[s("div",qe,[s("div",ze,_($.value),1),s("div",He,_(S.value),1)])])):R("",!0)]),_:1})],64))}}),Qe=Z(Ue,[["__scopeId","data-v-144c2896"]]);export{Qe as default};
